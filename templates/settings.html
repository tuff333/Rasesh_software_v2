{% extends 'base.html' %}
{% block content %}

<div class="card shadow">
  <div class="card-header">
    <h5 class="mb-0">Settings</h5>
  </div>

  <div class="card-body">

    <!-- NAVIGATION TABS -->
    <div class="mb-4 d-flex flex-wrap gap-2">
      <button class="btn btn-outline-primary settings-btn active" data-target="general">General</button>
      <button class="btn btn-outline-primary settings-btn" data-target="invoice">Invoices</button>
      <button class="btn btn-outline-primary settings-btn" data-target="email">Email</button>
      <button class="btn btn-outline-primary settings-btn" data-target="redactor">Redactor</button>
      <button class="btn btn-outline-primary settings-btn" data-target="shortcuts">Keyboard Shortcuts</button>
      <button class="btn btn-outline-primary settings-btn" data-target="advanced">Advanced</button>
    </div>

    <!-- PANELS WRAPPER -->
    <div>

      <!-- GENERAL -->
      <div class="settings-panel active" id="panel-general">
        <h4>General Settings</h4>
        <hr>

        <div class="mb-3">
          <label class="form-label">Theme</label>
          <select class="form-select" id="set-theme">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
            <option value="system">System Default</option>
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label">Default Upload Folder</label>
          <select class="form-select" id="set-upload-folder">
            <option value="default">Default</option>
            <option value="redaction">Redaction</option>
          </select>
        </div>
      </div>

      <!-- INVOICE SETTINGS -->
      <div class="settings-panel" id="panel-invoice">
        <h4>Invoice Settings</h4>
        <hr>

        <!-- Default Template -->
        <div class="mb-3">
          <label class="form-label">Default Invoice Template</label>
          <select class="form-select" id="set-default-template">
            <option value="classic">Classic</option>
            <option value="modern">Modern</option>
          </select>
          <div class="form-text">This template will be pre-selected when creating new invoices.</div>
        </div>

        <!-- Default Signature -->
        <div class="mb-3">
          <label class="form-label">Default Signature</label>
          <select class="form-select" id="set-default-signature">
            <option value="">None</option>
            {% if signatures %}
              {% for s in signatures %}
              <option value="{{ s.id }}">{{ s.name }}{% if s.position %} â€“ {{ s.position }}{% endif %}</option>
              {% endfor %}
            {% endif %}
          </select>
        </div>

        <!-- Default GST -->
        <div class="mb-3">
          <label class="form-label">Default GST Number</label>
          <select class="form-select" id="set-default-gst">
            <option value="">None</option>
            {% for g in gst_numbers %}
            <option value="{{ g.gst_number }}">{{ g.gst_number }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <!-- EMAIL SETTINGS -->
      <div class="settings-panel" id="panel-email">
        <h4>Email Settings</h4>
        <hr>

        <div class="mb-3">
          <label class="form-label">SMTP Host</label>
          <input type="text" class="form-control" id="smtp-host">
        </div>

        <div class="mb-3">
          <label class="form-label">SMTP Port</label>
          <input type="number" class="form-control" id="smtp-port" value="587">
        </div>

        <div class="mb-3">
          <label class="form-label">SMTP Username</label>
          <input type="text" class="form-control" id="smtp-username">
        </div>

        <div class="mb-3">
          <label class="form-label">SMTP Password</label>
          <input type="password" class="form-control" id="smtp-password">
        </div>

        <div class="mb-3">
          <label class="form-label">From Email</label>
          <input type="email" class="form-control" id="smtp-from">
        </div>

        <button class="btn btn-primary" id="smtp-test-btn">Send Test Email</button>
        <div id="smtp-test-result" class="mt-2 text-muted"></div>
      </div>

      <!-- REDACTOR -->
      <div class="settings-panel" id="panel-redactor">
        <h4>Redactor Settings</h4>
        <hr>

        <div class="form-check form-switch mb-3">
          <input class="form-check-input" type="checkbox" id="set-ocr-default">
          <label class="form-check-label">Enable OCR by default</label>
        </div>

        <div class="mb-3">
          <label class="form-label">Default Zoom Mode</label>
          <select class="form-select" id="set-zoom-mode">
            <option value="100">100%</option>
            <option value="fit-width">Fit Width</option>
            <option value="fit-page">Fit Page</option>
          </select>
        </div>

        <div class="form-check form-switch mb-3">
          <input class="form-check-input" type="checkbox" id="set-show-tips">
          <label class="form-check-label">Show Tips in Viewer</label>
        </div>
      </div>

      <!-- SHORTCUTS -->
      <div class="settings-panel" id="panel-shortcuts">
        <h4>Keyboard Shortcuts</h4>
        <hr>

        <p class="text-muted mb-3">
          Click a shortcut to change it. Press the new key combination, then release.
        </p>

        <div id="shortcut-list"></div>

        <div class="mt-3">
          <button class="btn btn-outline-secondary btn-sm" id="reset-shortcuts">
            Reset to Defaults
          </button>
        </div>
      </div>

      <!-- ADVANCED -->
      <div class="settings-panel" id="panel-advanced">
        <h4>Advanced Settings</h4>
        <hr>

        <div class="mb-3">
          <label class="form-label">Redacted Output Folder</label>
          <input type="text" class="form-control" id="set-output-redactions">
        </div>

        <div class="mb-3">
          <label class="form-label">Invoice Output Folder</label>
          <input type="text" class="form-control" id="set-output-invoices">
        </div>

        <div class="mb-3">
          <label class="form-label">Manifest Output Folder</label>
          <input type="text" class="form-control" id="set-output-manifests">
        </div>
      </div>

    </div>

  </div>
</div>

<script src="{{ url_for('static', filename='js/settings.js') }}"></script>

{% endblock %}
