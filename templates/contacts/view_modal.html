<div class="card border-0">
  <div class="card-body">

    <div class="d-flex align-items-center mb-3">
      {% if contact['face_image_contact'] %}
      <img src="/{{ contact['face_image_contact'] }}"
           class="rounded-circle me-3"
           style="width: 70px; height: 70px; object-fit: cover;">
      {% else %}
      <div class="rounded-circle bg-secondary text-white d-flex justify-content-center align-items-center me-3"
           style="width: 70px; height: 70px; font-size: 24px;">
        {{ contact['first_name_contact'][:1] }}{{ contact['last_name_contact'][:1] }}
      </div>
      {% endif %}

      <div>
        <h5 class="mb-0">
          {{ contact['first_name_contact'] }} {{ contact['last_name_contact'] }}
        </h5>
        <div class="text-muted">{{ contact['position_contact'] or 'No Title' }}</div>
        <div class="fw-bold">{{ contact['company_contact'] or '' }}</div>

        {% if tags %}
          <div class="mt-1">
            {% for t in tags %}
              <span class="badge bg-secondary">{{ t }}</span>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      {% if contact['company_logo_contact'] %}
      <img src="/{{ contact['company_logo_contact'] }}"
           class="ms-auto"
           style="width: 60px; height: 60px; object-fit: contain;">
      {% endif %}
    </div>

    <div class="row mb-3">
      <div class="col-md-6">
        <p class="mb-1"><i class="bi bi-envelope"></i> {{ contact['email_contact'] or '-' }}</p>
        <p class="mb-1"><i class="bi bi-telephone"></i> {{ contact['phone_contact'] or '-' }}</p>
        <p class="mb-1"><i class="bi bi-globe"></i> {{ contact['website_contact'] or '-' }}</p>
      </div>
      <div class="col-md-6">
        <p class="mb-1"><i class="bi bi-geo-alt"></i> {{ contact['address_contact'] or '-' }}</p>
      </div>
    </div>

    <div class="mb-3">
      <h6 class="text-primary"><i class="bi bi-card-text"></i> Notes</h6>
      {% if notes %}
        <ul class="list-unstyled mb-0">
          {% for n in notes %}
          <li class="mb-1">
            <small class="text-muted">{{ n['timestamp'] }}</small><br>
            {{ n['note_text'] }}
          </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-muted mb-0">No notes yet.</p>
      {% endif %}
    </div>

    <div class="mb-3">
      <h6 class="text-primary"><i class="bi bi-credit-card"></i> Business Card</h6>
      <div class="row">
        <div class="col-md-6">
          <small class="text-muted">Front</small><br>
          {% if contact['business_card_front_contact'] %}
            {% if contact['business_card_front_contact'].endswith('.pdf') %}
              <a href="/{{ contact['business_card_front_contact'] }}" target="_blank">View PDF</a>
            {% else %}
              <img src="/{{ contact['business_card_front_contact'] }}" class="img-fluid rounded border">
            {% endif %}
          {% else %}
            <span class="text-muted">None</span>
          {% endif %}
        </div>
        <div class="col-md-6">
          <small class="text-muted">Back</small><br>
          {% if contact['business_card_back_contact'] %}
            {% if contact['business_card_back_contact'].endswith('.pdf') %}
              <a href="/{{ contact['business_card_back_contact'] }}" target="_blank">View PDF</a>
            {% else %}
              <img src="/{{ contact['business_card_back_contact'] }}" class="img-fluid rounded border">
            {% endif %}
          {% else %}
            <span class="text-muted">None</span>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="d-flex justify-content-end mt-3">
      {% set email = contact['email_contact'] or '' %}
      {% set phone = contact['phone_contact'] or '' %}
      {% set full_name = (contact['first_name_contact'] or '') ~ ' ' ~ (contact['last_name_contact'] or '') %}

      <a href="mailto:{{ email }}?subject=Hello%20{{ full_name | urlencode }}"
         class="btn btn-sm btn-outline-primary me-2">
        <i class="bi bi-envelope"></i> Email
      </a>

      <a href="tel:{{ phone }}" class="btn btn-sm btn-outline-success me-2">
        <i class="bi bi-telephone"></i> Call
      </a>

      <a href="{{ url_for('contacts.export_ics', id=contact['id']) }}"
         class="btn btn-sm btn-outline-warning me-2">
        <i class="bi bi-calendar-event"></i> Meeting
      </a>

      <a href="{{ url_for('contacts.export_vcard', id=contact['id']) }}"
         class="btn btn-sm btn-outline-secondary me-2">
        <i class="bi bi-person-vcard"></i> vCard
      </a>

      <a href="{{ url_for('contacts.contacts_edit', id=contact['id']) }}"
         class="btn btn-sm btn-outline-secondary me-2">
        <i class="bi bi-pencil"></i> Edit
      </a>

      <a href="{{ url_for('contacts.view_contact', id=contact['id']) }}"
         class="btn btn-sm btn-outline-dark">
        <i class="bi bi-box-arrow-up-right"></i> Full View
      </a>
    </div>

  </div>
</div>
