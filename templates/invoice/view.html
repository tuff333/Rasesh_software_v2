{% extends 'base.html' %}
{% block content %}

<div class="card shadow">
  <div class="card-header">
    <h5><i class="bi bi-receipt"></i> Invoice Details â€“ {{ invoice.num }}</h5>
  </div>

  <div class="card-body">

    <div class="row mb-3">
      <div class="col-md-4"><b>Invoice Type:</b> {{ invoice.invoice_type }}</div>
      <div class="col-md-4"><b>Date:</b> {{ invoice.date }}</div>
      <div class="col-md-4"><b>Vendor:</b> {{ vendor.name }}</div>
    </div>

    <div class="row mb-3">
      <div class="col-md-4"><b>GST:</b> {{ vendor.gst_number }}</div>
      <div class="col-md-4"><b>Phone:</b> {{ vendor.phone }}</div>
      <div class="col-md-4"><b>Email:</b> {{ vendor.email }}</div>
    </div>

    <hr>

    <h5>Line Items</h5>
    <table class="table table-sm table-bordered">
      <thead>
        <tr>
          <th>Lot #</th>
          <th>Item</th>
          <th>Qty</th>
          <th>Units</th>
          <th>Unit Price</th>
          <th>Line Total</th>
        </tr>
      </thead>
      <tbody>
        {% for it in items %}
        <tr>
          <td>{{ it.lot_number }}</td>
          <td>{{ it.item }}</td>
          <td>{{ it.qty }}</td>
          <td>{{ it.units }}</td>
          <td>${{ "%.2f"|format(it.unit_price) }}</td>
          <td>${{ "%.2f"|format(it.line_total) }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <hr>

    <div class="row mb-3">
      <div class="col-md-3"><b>Subtotal:</b> ${{ "%.2f"|format(invoice.subtotal) }}</div>
      <div class="col-md-3"><b>Tax:</b> ${{ "%.2f"|format(invoice.tax) }}</div>
      <div class="col-md-3"><b>Shipping:</b> ${{ "%.2f"|format(invoice.ship_cost) }}</div>
      <div class="col-md-3"><b>Total:</b> ${{ "%.2f"|format(invoice.total) }}</div>
    </div>

    <hr>

    <div class="mb-3">
      <b>Comments:</b><br>
      {{ invoice.comments }}
    </div>

    <div class="mb-3">
      <b>Terms & Conditions:</b><br>
      {{ invoice.terms_conditions }}
    </div>

    <div class="text-end">
      {% if invoice.pdf %}
      <a href="{{ url_for('invoice_routes.invoice_download', filename=invoice.pdf) }}"
         class="btn btn-primary">
        <i class="bi bi-file-earmark-pdf"></i> Download PDF
      </a>
      {% endif %}
    </div>

  </div>
</div>

{% endblock %}
